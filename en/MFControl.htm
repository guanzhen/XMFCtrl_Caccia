
<HTML>

<HEAD>
  <!-- Dhtmlx Common -->
  <script src="../../../codebase/dhtmlxcommon.js"></script>
  <script src="../../../codebase/dhtmlxcontainer.js"></script>

  <!-- Dhtmlx Grid -->
  <link rel="stylesheet" type="text/css" href="../../../codebase/grid/skins/dhtmlxgrid_dhx_skyblue.css">
  <link rel="stylesheet" type="text/css" href="../../../codebase/grid/dhtmlxgrid.css">
  <script src="../../../codebase/grid/dhtmlxgrid.js"></script>
  <script src="../../../codebase/grid/dhtmlxgridcell.js"></script>  
  <script src="../../../codebase/grid/ext/dhtmlxgrid_srnd.js"></script>
  <script src="../../../codebase/grid/ext/dhtmlxgrid_data.js"></script>
    
  <!-- Dhtmlx Windows -->
  <link rel="stylesheet" type="text/css" href="../../../codebase/windows/skins/dhtmlxwindows_dhx_skyblue.css">
  <link rel="stylesheet" type="text/css" href="../../../codebase/windows/dhtmlxwindows.css">
  <script src="../../../codebase/windows/dhtmlxwindows.js"></script>
  
  <!-- Dhtmlx TabBar -->
  <link rel="stylesheet" type="text/css" href="../../../codebase/tabbar/dhtmlxtabbar.css">
  <script src="../../../codebase/tabbar/dhtmlxtabbar.js"></script>

  <STYLE>
  html { background-color : #97A0A5;}
  h1 {font-size: 12pt;color:white;margin:5px 0px 5px 0px;font-family:arial}
  body {margin:2px;font-size: 12pt;color:white;font-family:arial}
  button {width:150px}
  input {width:150px;}
  select {width:150px;}   
  #ButtonGridClear {margin-top:20px;float:right; width: 100px;height:34px;align:right;}
  #ButtonDebugLog  {margin-top:5px;clear:right;float:right; width: 100px;height:34px;}  
  #ButtonGetSCIbuffer  {margin-top:5px;clear:right;float:right; width: 100px;height:34px;}  
  #Layer_Main   {padding: 0px; height:62.5%; width:100%;}
  #Layer_TabStrip   {padding: 2px; height:89% ;width:100%;}
  #Layer_MessageLog {padding: 0px; height:100% ; width:100%;}
  #MessageLogObj {height:100%; width :100%;}  
  #LayerCommand  {float:left;width :49.5%; height:380px}
  #LayerReply    {float:left;width :49.5%;height:380px}  
  #LayerPeripherals { position: absolute; top:301px;}

  .GrpFrame
  {
    border-color:     white;
    border-style:     solid;
    border-width:     2px;
    filter:           progid:DXImageTransform.Microsoft.Gradient(startColorStr='#AA312C',endColorStr='#A4312C',gradientType='1');
    Background-color: #AA312C;
    margin:           2px;
    padding:          2px;
  }
  #Layer_Logs   {padding: 0px; height:37% ;width:100%;}
  </STYLE>
</HEAD>

<BODY>

  <div id="Layer_Main" class = "GrpFrame">
  <table>
    <td><span style = "color = white;font-size = 10pt;font-family=arial;margin=0px;">Can ID: 0x</span></td>
    <td><input id = "inputCANID" style = "width: 27px"></input></td>
    <td><select id = "opt_SlotNum" style = "width:50px;" ></select></td>
    <td><button id = "btnAssignCANID" class = "ButtonInfo">Assign CANID</button></td>
    <td><button id = "btnGetApp" class = "ButtonInfo">Read Info</button></td>
    <td><button id = "btnReset" class = "ButtonInfo">Reset</button></td>
  </table>
  
  <div id="LayerCommand" class = "GrpFrame">
  <!-- Measure Component~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
    <div id="SubLayerMeasure" >
      <h1>Measurement Controls</h1>
      <table> 
      <tr><td>Contact Module</td>
        <td><select id = "opt_CMID" style = "width:35px">
        <option value = "0x01">1</option>
        <option value = "0x02">2</option>
        <option value = "0x03">3</option>
        </select>
        <td>Freq.</td>
        <td>
          <select id = "optFrequency" style = "width:80px">
            <option value = "0">Auto</option>
            <option value = "1">1 kHz</option>
            <option value = "2">10 kHz</option>
          </select>      
        </td>
        <td title ="Series for C/L, Parallel for R">Model</td>
        <td>
        <select id = "optModel" style = "width:80px">
          <option value = "0">Auto</option>
          <option value = "1">Series</option>
          <option value = "2">Parallel</option>
        </select>      
        </td>
      </tr>
      </table>
      <hr>
      <div>
        <div style = "padding-right:5px;float:right;clear:left">
          <button id="btn_setupmeasure" style = "height:50px"> Setup Measure</button><br><br>
          <button id="btn_measure" style = "height:50px;clear:right"> Measure </button>
        </div>
        <div style = "float:left;height:150px">
          <table id="TableComponent">
            <tr>
              <td>Component Type 
              <td><select id = "optMeasureCommand" >
                <option value = "1">Resistor</option>
                <option value = "2">Capacitor</option>
                <option value = "3">Inductor</option>
                <option value = "4">Forward Voltage</option>
                <option value = "5">Polar Cap</option>
              </select>
            </tr>
            <tr id = "param_expectedVal">
              <td>Component Value </td>
              <td><input id="ip_param_setupExpectedVal"></input></td>
              <td id="ParamUnit"> </td>
            </tr>
            <tr id="param_voltage"><td>Max Voltage</td> <td><input id = "ip_paramvoltage" ></input><td>V</td>    
            <tr id="param_current"><td>Current<td><select id = "optCurrSel">
              <option value = "0.002">2mA</option>
              <option value = "0.010">10mA</option>              
            </select>
            <tr id="param_maxvoltage"><td>Max Voltage</td> <td><input id = "ip_parammaxvoltage" ></input><td>V</td>
            <tr id="param_numofcycle" title = "[0 = Auto]"><td>NumOfCycles (Opt)</td> <td><input id = "ip_paramnumofcycles" ></input></td>
            <tr id="param_polarity" title = "[0 = Normal, 1 = Inverted]"><td>Polarity (Opt)</td> <td><input id = "ip_parampolarity" ></input></td>
          </table>
        </div>
        <hr style = "float:left;clear:left;">
        <table>
          <tr>
           <td><button style="width:150px" id="btn_endurance"> Endurance</button>
           <td><button style="width:150px" id="btn_endu_stop"> Stop </button>
          </tr>
        </table>
      </div>
    </div>
    <hr> 
    <div id="SubLayerTools" >
      <h1> Functions </h1>
      <table>
      <tr><td><button style="width:150px" id="btn_calibrate"> Calibration </button></td>
      <td>
        <select style = "width:180px;" id = "opt_SubCmd">
        <option value = "0x01">1: Closed Loop</option>
        <option value = "0x02">2: Closed Loop Cal</option>
        <option value = "0x03">3: Open Loop</option>
        <option value = "0x04">4: Restore Calibrated Data</option>
        </select>
      </td>
      </tr>
      <tr>
      <td><button style="width:150px" id="btn_selftest"> Self Test </button><br></td>
      </tr>
      </table>
    </div>
  </div>
  
  <div id="LayerReply" class = "GrpFrame">
    <h1>Results</h1>
    <div id= "LayerResults">
    <table>
      <!-- For Selftest and setup measure -->
      <tr id="param_ContactRes">  <td>Contact Res</td>          <td><input id = "op_paramContactres" ></input> Ohm</td>    
      <tr id="param_CapacityCM">    <td>Capacitance CM</td>     <td><input id = "op_paramCapacityCM" ></input> F</td>
      <tr id="param_ResistanceCM">  <td>Resistance CM</td>      <td><input id = "op_paramResistanceCM" ></input> Ohm</td>
      
      <!-- For measurements -->
      <tr id="param_CompType1">     <td>Primary Attribute</td>      <td><input id = "op_paramcomptype1" ></input></td>
      <tr id="param_Type1Value">    <td>Parameter 1 value</td>      <td><input id = "op_paramType1Value" ></input></td>
      <tr id="param_Type1ValueMin"> <td>Parameter 1 value Min</td>  <td><input id = "op_paramType1ValueMin" ></input></td>
      <tr id="param_Type1ValueMax"> <td>Parameter 1 value Max</td>  <td><input id = "op_paramType1ValueMax" ></input></td>
      <tr id="param_CompType2">     <td>Secondary Attribute</td>    <td><input id = "op_paramcomptype2" ></input></td>
      <tr id="param_Type2Value">    <td>Parameter 2 value</td>      <td><input id = "op_paramType2Value" ></input></td>
      <tr id="param_Type2ValueMin"> <td>Parameter 2 value Min</td>  <td><input id = "op_paramType2ValueMin" ></input></td>
      <tr id="param_Type2ValueMax"> <td>Parameter 2 value Max</td>  <td><input id = "op_paramType2ValueMax" ></input></td>
      <tr id="param_fwdvoltage">    <td>Forward Voltage</td>        <td><input id = "op_paramfwdvoltage" ></input> V</td>
      <tr id="param_fwdcurrent">    <td>Forward Current</td>        <td><input id = "op_paramfwdcurrent" ></input> I</td>
      <tr id="param_res1k">         <td>Res. 1KHz</td>              <td><input id = "op_paramres1k" ></input> Ohm</td>
      <tr id="param_reac1k">        <td>Reac. 1KHz</td>             <td><input id = "op_paramreac1k" ></input> Ohm</td>
      <tr id="param_res10k">        <td>Res. 10KHz</td>             <td><input id = "op_paramres10k" ></input> Ohm</td>
      <tr id="param_reac10k">       <td>Reac. 10KHz</td>            <td><input id = "op_paramreac10k" ></input> Ohm</td>
      
      <!-- For selftest,setup measure and measurements -->
      <tr id="param_U">        <td>Voltage</td>                <td><input id = "op_paramU" ></input> V</td>
      <tr id="param_I">        <td>Current </td>               <td><input id = "op_paramI" ></input> A</td>
      <tr id="param_Phi">      <td>Phase</td>                  <td><input id = "op_paramPhi" ></input> Deg</td>
      <tr id="param_Freq">     <td>Frequency</td>              <td><input id = "op_paramFreq" ></input> Hz</td>
      
    </table>  
    </div>
    <div id="LayerPeripherals">
      <hr>
      <h1>Peripherals</h1>
      <table>
      <tr><td><button style="width:150px" id="btn_getcover"> Get Cover Status </button></td><td><img id="ledcover" class="LedImgStyle"  src="./icon/led_black.png"></img></td></tr>
      <tr><td><button style="width:150px" id="btn_gettemp"> Get Temperature</button></td><td><input id = "op_paramtemp" style ="width:50px;"> Degrees</input></td></tr>
      </table>
    </div>
  </div>  

  </div>
  
  
  <div id="Layer_Logs">
    <div id="Layer_TabStrip"  class = "GrpFrame">
    <button id="ButtonGridClear" title="Clear content in message window.">Clear</button>  
    <button id="ButtonDebugLog" title="Open/Close debuglog window.">DebugLog</button>  
    <button id="ButtonGetSCIbuffer" title="Get the most recent SCI data.">Read SCI</button>  
      <div id="Layer_MessageLog">
        <div id="MessageLogObj"></div>
        <!-- <button id="ButtonDebugLog" title="Creates Debug Window">Start DebugLog</button>         -->
      </div>
      <div id="Layer_SCILog">
        <div id="SCILogObj"></div>
      SCI Log
      </div>
    </div>
  </div>
  <div id="Layer_CanSetup"></div> 
 

</BODY>

<!-- Create DHTMLX pop up CAN setup window -->
<script language="JScript" type="text/javascript">
  var dhxWins,win,winframe,dhxForm,formStructure,menu
  var opt_net,opt_config

  formStructure = [

    {type:"settings",position:"label-top"},
    {type: "fieldset",name:"cansetup", label: "Can Setup", list:[
      {type: "combo", label: "Net", name: "combonet", options:[
      {text: "1", value: "0",selected: true},
      {text: "2", value: "1" }
      ]},
      {type:"newcolumn"},
      {type: "combo", label: "Configuration", name: "comboconfig",  inputLeft:50,  options:[
      {text: "Upstream", value: "0", selected: true},
      {text: "DownStream", value: "1" }
      ]},
      {type:"button", name:"Connect",width:100,offsetTop:10,offsetLeft:100, value:"Connect"}
    ]}
  ];
  dhxWins = new dhtmlXWindows();
  dhxWins.load_cansetup = function()
  {
    win = dhxWins.createWindow("cansetup", 100, 100, 500 , 200);
    win.button("minmax1").hide();
    win.button("park").hide();
    win.button("close").hide();
    win.setText("CAN Setup");
    win.attachURL("CanSetup.html");
    win.center();
    winframe = win.getFrame();
  }
  dhxWins.canconnect = function()
  {
    opt_config = winframe.contentWindow.document.getElementById("opt_config").value;
    opt_net = winframe.contentWindow.document.getElementById("opt_cannet").value;
    win.close();
  }
</script> 

<!-- Create message log DHTMLX object-->
<script language="JScript" type="text/javascript">
  var LogGrid = new dhtmlXGridObject('MessageLogObj');
  LogGrid.load_messagebox = function()
  {
    LogGrid.setHeader("Date,Time,Information");
    LogGrid.setImagePath("../../../codebase/grid/imgs/");
    LogGrid.setInitWidths( "100,100,*");
    LogGrid.setColAlign ("center,center,left");
    LogGrid.setColTypes ("ro,ro,ro");
    LogGrid.setColSorting ("na,na,na");
    LogGrid.setSkin ("red_gray");
    LogGrid.setStyle("color:black;font-weight:bold;","color:black;","","")
    LogGrid.enableTooltips ("true,true,true");
    LogGrid.enableResizing ("false,false,false");
    LogGrid.enableMultiselect(false);
    LogGrid.enableAutoWidth (true);
    LogGrid.enableSmartRendering(true);
    LogGrid.init();
  }
</script>

<!-- Create message log DHTMLX object-->
<script language="JScript" type="text/javascript">
  var SCIGrid = new dhtmlXGridObject('SCILogObj');
  SCIGrid.load_messagebox = function()
  {
    SCIGrid.setHeader("Date,Time,Information");
    SCIGrid.setImagePath("../../../codebase/grid/imgs/");
    SCIGrid.setInitWidths( "100,100,*");
    SCIGrid.setColAlign ("center,center,left");
    SCIGrid.setColTypes ("ro,ro,ro");
    SCIGrid.setColSorting ("na,na,na");
    SCIGrid.setSkin ("red_gray");
    SCIGrid.setStyle("color:black;font-weight:bold;","color:black;","","")
    SCIGrid.enableTooltips ("true,true,true");
    SCIGrid.enableResizing ("false,false,false");
    SCIGrid.enableMultiselect(false);
    SCIGrid.enableAutoWidth (true);
    SCIGrid.enableSmartRendering(true);
    SCIGrid.init();
  }
</script>

<script language = "JScript" type="text/javascript"> 
  tabbar = new dhtmlXTabBar("Layer_TabStrip","top");
  tabbar.enableAutoReSize( true );
  tabbar.setImagePath("../../../codebase/tabbar/imgs/");
  tabbar.setSkin("silver");
  tabbar.addTab("main_tab1","Message Log");
  tabbar.addTab("main_tab2","SCI Log");
  tabbar.setContent( "main_tab1", Layer_MessageLog);
  tabbar.setContent( "main_tab2", Layer_SCILog);

  for ( var i = 1; i <= tabbar.getNumberOfTabs(); i++ )
  {
    tabbar.setCustomStyle( 'main_tab' + i, 'gray', 'black', 'font-size:10pt;font-family:Arial;font-weight: bold;' );
  }
  tabbar.setTabActive("main_tab1");
</script>
</HTML>

